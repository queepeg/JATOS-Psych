<!doctype html>
<html>
  <head>
    <title>MSJH</title>
      <script src="/assets/javascripts/jatos.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
      <script src="/study_assets/MSJH/jspsych-5.0.3/jspsych.js"></script>
	  <script src="/study_assets/MSJH/jspsych-5.0.3/plugins/jspsych-text.js"></script>
      <script src="/study_assets/MSJH/jspsych-5.0.3/plugins/jspsych-instructions.js"></script>
	  <script src="/study_assets/MSJH/jspsych-5.0.3/plugins/jspsych-single-stim.js"></script>
	  <link href="/study_assets/MSJH/jspsych-5.0.3/css/jspsych.css" rel="stylesheet" type="text/css"></link>
  </head>
  <body>
  <script>

  /* create the experiment timeline */
  var timeline = [];
  var wordColor;
  var boolNegativePositive;

  /* instructions */
  var instructions = {
    type: 'instructions',
    pages: ['<p>This is' +
    ' a ' +
    'MODIFIED STEINBERG! ' +
    'MODIFIED STEINBERG!</p>' +
    '<p style="font-weight:bold;">Press Y if the word BLUE</p>' +
    '<p style="font-weight:bold;">Press N if the word is RED.</p>' +
    '<p>Click the button below to begin.</p>'
    ],
    allow_keys: false,
    show_clickable_nav: true
  };

  timeline.push(instructions);

//present fixation cross for 500ms
var fixation = {
    type: 'single-stim',
    stimulus: '/study_assets/MSJH/img/fixation.png',
    timing_post_trial: 0,
	timing_stim: 500,
	timing_response: 500,
    response_ends_trial: false
};


timeline.push(fixation);

	var learningScreen = {
    type: 'single-stim',
	stimulus: function() {

	// Array of words to be used
	var positiveArray = ["smile","joy","triumph","love","peace"];
	var negativeArray = ["hate","war","death","decay","violence"];
	var mixedArray = ["red","green","yellow","purple","black", "white", "orange", "pink"];

	// Array of colors to be used and randomised
	var intColor = Math.floor(Math.random() * 100);

	if (intColor < 50) {
		var randomColor = "Red";
		var altColor = "Blue";
    } else {
		var randomColor = "Blue";
		var altColor = "Red";
    }

	//Array to slice the words
	stimPArray = jsPsych.randomization.sample(positiveArray, 3, false);
	stimNArray = jsPsych.randomization.sample(negativeArray, 3, false);
	stimMArray = jsPsych.randomization.sample(mixedArray, 6, false);

	//position code
	var intPos = Math.floor(Math.random() * 100);

    if (intPos < 21) {
        wordColor = 'Mixed';

	   return '<div class=' + randomColor + '><div class=topLeft>' + stimMArray[0] + '</div><div class=topMiddle>' + stimMArray[1] + '</div><div class=topRight>' + stimMArray[2] + '</div></div>' + '<div class=' + altColor + '><div class=bottomLeft>' + stimMArray[3] + '</div><div class=bottomMiddle>' + stimMArray[4] + '</div><div class=bottomRight>' + stimMArray[5] + '</div></div>';
    } else if (intPos > 60) {
        wordColor = randomColor;
        boolNegativePositive = false;

	   return '<div class=' + randomColor + '><div class=topLeft>' + stimNArray[0] + '</div><div class=topMiddle>' + stimNArray[1] + '</div><div class=topRight>' + stimNArray[2] + '</div></div>' + '<div class=' + altColor + '><div class=bottomLeft>' + stimPArray[0] + '</div><div class=bottomMiddle>' + stimPArray[1] + '</div><div class=bottomRight>' + stimPArray[2] + '</div></div>';
	} else {
        wordColor = randomColor;
        boolNegativePositive = true;

	return '<div class=' + randomColor + '><div class=topLeft>' + stimPArray[0] + '</div><div class=topMiddle>' + stimPArray[1] + '</div><div class=topRight>' + stimPArray[2] + '</div></div>' + '<div class=' + altColor + '><div class=bottomLeft>' + stimNArray[0] + '</div><div class=bottomMiddle>' + stimNArray[1] + '</div><div class=bottomRight>' + stimNArray[2] + '</div></div>';
  } },
    is_html: true,
    timing_post_trial: 800,
	timing_stim: 7800,
	timing_response: 7800,
    response_ends_trial: false
};

timeline.push(learningScreen);

//variable to determine colour and array used for current trial
if (typeof boolNegativePositive === "undefined"){
    currentTrial = wordColor;
    // console.warn("boolNegativePositive is undefined!")
} else {
    currentTrial = wordColor + boolNegativePositive.toString();
}
//variable to determine color of cue to be shown

var cue = {
    type: 'single-stim',
    stimulus: function() {

//variable to determine probability of cue color drawn by var cue
var cueRandomColor = Math.floor(Math.random() * 100);

if (currentTrial === "Mixed"){
    // choose randomly between .redCue and .blueCue
    var intCueColor = Math.floor(Math.random() * 100);

	if (intCueColor < 50) {
		var cueColor = "RedCue";
    } else {
		var cueColor = "BlueCue";
    }

    cueLabel = "random";
} else if (currentTrial === "RedFalse" || "BlueTrue") {
    if (cueRandomColor < 71) {
        var cueColor = "BlueCue";
        cueLabel = "posRel";
    } else {
    // else display .redCue
    var cueColor = "RedCue";
    cueLabel = "negRel";
    }
} else {
    // (FOR EVERYTHING ELSE)
    if (cueRandomColor < 71) {
    // then display .redCue
    var cueColor = "RedCue";
    cueLabel = "posRel";
    } else {
    // display .blueCue
    var cueColor = "BlueCue";
    cueLabel = "negRel";
    }
}
// Return the result
return "<div class=" + cueColor + ">" + cueLabel + " " + currentTrial + "</div>";
},
is_html: true
};

timeline.push(cue)

//testing ability to recall previous random words

var probe = {
    type: 'single-stim',
    stimulus: function() {

        return '<div class=' + wordColor + '>' + stimNArray[0] + wordColor + boolNegativePositive.toString() + '</div>';
    },
    is_html: true
    };

timeline.push(probe);

/*Defining desired logic behind Var Probe....

We need three arrays made up of words that have been displayed on the learning screen

Var oldPositiveWords ["stimPArray[0]","stimPArray[1]","stimPArray[2]"
Var oldNegativeWords ["stimNArray[0]","stimNArray[1]","stimNArray[2]"
Var oldMixedWords ["stimMArray[0]","stimMArray[1]","stimMArray[2]","stimMArray[3]","stimMArray[4]","stimMArray[5]"]
*/

jatos.onLoad(function() {
    jsPsych.init({
        timeline: timeline,

        //Once it has finished send the result data back to Jatos
        on_finish: function() {
            var resultJson = JSON.stringify(jsPsych.data.getData());
            jatos.submitResultData(resultJson, jatos.startNextComponent);
        }
    });
});
    </script>
    </body>
</html>

